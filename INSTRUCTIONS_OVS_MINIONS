README: Instructions
//------------------------
// TO BUILD THE EXPERIMENT:
// ------------------------

1. Clone https://github.com/slab14/IoT_Sec_Gateway on all machines
2. Run ./IoT_Sec_Gateway/setup-node.sh on both node0 & node1
3a. Modify IoT_Sec_Gateway/setup-data-plane.sh to checkout the feature-signing (line 77)
3b. Run ./IoT_Sec_Gateway/setup-data-plane.sh on dataplane (note, this clones my fork of OVS onto the machine and install it)
-- Now you should have OVS setup, if you add routing rules you should be able to send packets between node0 & node1 --

sudo ovs-ofctl del-flows br0
8. Add middlebox to verify/remove signatures. on dataplane:
8a. build middlebox:
sudo docker build -t sign_box IoT_Sec_Gateway/docker_containers/append/
8b. attach middlebox to OVS:
sudo docker run -itd --network=none --rm --cap-add=NET_ADMIN --name=middlebox sign_box
sudo ovs-docker add-port br0 eth0 middlebox
sudo ovs-docker add-port br0 eth1 middlebox

-- Missing step:  (The problem that you had, is that you are trying to do my userspace demo with a kernel space switch. I forgot to include this instruction. )
sudo ovs-vsctl set Bridge br0 datapath_type=netdev

-- find the OVS ports for the middlebox --
sudo ovs-ofctl show br0
-- assuming the middlebox is using OVS ports 3 & 4 for eth0 & eth1 respectively --
// CREATE THE RULES TO TEST WITH PING
8c. add routing rules:
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=1 actions=sign,3"
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=4 actions=2"
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=2 actions=4"
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=3 actions=verify,1"

//--------------------
// TO TEST CHANGES
//----------------------

// stop current service
sudo /usr/share/openvswitch/scripts/ovs-ctl stop
sudo /usr/share/openvswitch/scripts/ovs-ctl status

// update OVS code located in /users/santiagc/ovs folder
cd /users/santiagc/ovs
sudo make clean
sudo make install

// start service again
sudo /usr/share/openvswitch/scripts/ovs-ctl start --system-id

// have to create again only the rules
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=1 actions=sign,3"
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=4 actions=2"
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=2 actions=4"
sudo ovs-ofctl -O Openflow13 add-flow br0 "in_port=3 actions=verify,1"

Testing purposes just ping
